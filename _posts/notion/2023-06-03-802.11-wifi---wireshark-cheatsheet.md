---
layout: post
comments: true
date: 2023-06-03
title: "802.11 WiFi - Wireshark Cheatsheet" 
tags:
  - wifi
  - networking
  - wireshark
  - 802.11
 
categories:
  - software

---

Display Filter Macros are a mechanism to create shortcuts for complex filters. For example, defining a display filter macro named _tcp_conv_ whose text is


```text
(ip.src == $1 and ip.dst == $2 and tcp.srcport == $3 and tcp.dstport == $4)
or (ip.src == $2 and ip.dst == $1 and tcp.srcport == $4 and tcp.dstport == $3)
```


would allow to use a display filter like


```text
${tcp_conv:10.1.1.2;10.1.1.3;1200;1400}
```


instead of typing the whole filter.


Display Filter Macros can be managed with a user table, as described in [Section 11.7, “User Table”](https://www.wireshark.org/docs/wsug_html_chunked/ChUserTable.html), by selecting Analyze → Display Filter Macros from the menu. The User Table has the following fields:


**Name** The name of the macro.


**Text** The replacement text for the macro it uses $1, $2, $3, … as the input arguments.



  </details>
```c
(wlan.addr == $1 && wlan.addr == $2) || (wlan.addr == $2 && wlan.addr == $1 && wlan.type.eq(0) && wlan.fc.type_subtype == 0x1D)
```


```c
&& (!(wlan.fc.type_subtype == 4 || wlan.fc.type_subtype == 5 || wlan.fc.type_subtype == 8 ))
```


---


## Management Frames


Used for the control of the wireless network and the devices that connect to it. Management frames can be used for establishing and maintaining connections, as well as for signaling important events like re-association or authentication. 


| wlan.fc.type == 0          | all Management Frames   | description                                                                                                                                                                                          |
| -------------------------- | ----------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wlan.fc.type_subtype == 0  | Association Requests    | The frame is an Association Request, which is sent by a client to request association with an access point (AP).                                                                                     |
| wlan.fc.type_subtype == 1  | Association Response    | The frame is an Association Response, which is sent by an AP to indicate the status of an association request from a client.                                                                         |
| wlan.fc.type_subtype == 2  | Re-association Request  | The frame is a Re-association Request, which is sent by a client to request re-association with an AP. This is typically used when a client roams from one AP to another within the same network.    |
| wlan.fc.type_subtype == 3  | Re-association Response | The frame is a Re-association Response, which is sent by an AP to indicate the status of a re-association request from a client.                                                                     |
| wlan.fc.type_subtype == 4  | Probe Requests          | The frame is a Probe Request, which is sent by a client to discover available networks. It is used to obtain information about nearby APs.                                                           |
| wlan.fc.type_subtype == 5  | Probe Responses         | The frame is a Probe Response, which is sent by an AP to provide information about its capabilities and services in response to a Probe Request from a client.                                       |
| wlan.fc.type_subtype == 8  | Beacons                 | The frame is a Beacon, which is periodically transmitted by an AP to announce its presence and provide information about the network.                                                                |
| wlan.fc.type_subtype == 9  | ATIMs                   | The frame is an ATIM (Ad-hoc Traffic Indication Map), which is used in ad-hoc networks to allocate the medium access time for stations to transmit data.                                             |
| wlan.fc.type_subtype == 10 | Disassociations         | The frame is a Disassociation, which is sent by a client or AP to terminate an association. It indicates the intention to leave the network.                                                         |
| wlan.fc.type_subtype == 11 | Authentications         | The frame is an Authentication, which is used to authenticate a client with an AP. It is exchanged before association and provides security in the initial stages of the connection.                 |
| wlan.fc.type_subtype == 12 | Deauthentications       | The frame is a Deauthentication, which is sent by a client or AP to terminate an authenticated session. It is used to indicate a forced logoff or access denial.                                     |
| wlan.fc.type_subtype == 13 | Actions                 | The frame is an Action, which is used to exchange vendor-specific or non-standardized messages between clients and APs. It provides a mechanism for extending the capabilities of the Wi-Fi network. |


## Control Frames


Control frames are used to manage the transmission of data between wireless devices, and are critical to ensuring that network resources are used efficiently and effectively.


| wlan.fc.type == 1          | All Control Frames     | Description                                                                                                                                                                                                                                                          |
| -------------------------- | ---------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| wlan.fc.type_subtype == 24 | Block Ack Requests     | The frame is a Block Ack Request, which is sent by the receiver to request the sender to acknowledge the successful receipt of multiple frames. It optimizes the acknowledgment process by reducing the number of individual acknowledgments.                        |
| wlan.fc.type_subtype == 25 | Block Ack              | The frame is a Block Ack, which is sent by the sender to acknowledge the successful receipt of multiple frames as requested by the Block Ack Request. It confirms the successful delivery of a group of frames.                                                      |
| wlan.fc.type_subtype == 26 | PS-Polls               | The frame is a PS-Poll (Power Save Poll), which is sent by a power-saving station to the access point (AP) to indicate its desire to receive buffered frames. It allows the power-saving station to check for any pending frames while minimizing power consumption. |
| wlan.fc.type_subtype == 27 | RTS (Request-to-Send)  | The frame is an RTS, which is sent by a sender to request permission to transmit a data frame. It is used in the RTS/CTS (Request-to-Send/Clear-to-Send) handshake mechanism to avoid collisions in the wireless medium.                                             |
| wlan.fc.type_subtype == 28 | CTS (Clear-to-Send)    | The frame is a CTS, which is sent by the receiver in response to an RTS frame. It grants permission to the sender to transmit a data frame, indicating that the medium is clear for transmission.                                                                    |
| wlan.fc.type_subtype == 29 | ACKs (Acknowledgments) | The frame is an ACK, which is sent by the receiver to acknowledge the successful receipt of a data frame. It serves as a positive acknowledgment to inform the sender that the frame was received without errors.                                                    |
| wlan.fc.type_subtype == 30 | CF-Ends                | The frame is a CF-End (Contention Free End), which is sent by a station to inform other stations that it has finished its contention-free period and the medium is available for contention-based access.                                                            |
| wlan.fc.type_subtype == 31 | CF-Ends/CF-Acks        | The frame is a CF-End/CF-Ack, which is sent by the access point (AP) to acknowledge the CF-End frame and indicate the end of the contention-free period. It is used in contention-free access methods to maintain synchronization.                                   |


## Data Frames


Data frames are used to transfer information **or** trigger an event. Not all data frames contain a payload, some are “null data frames” and only contain a header and trailer.


| wlan.fc.type == 2          | all data frames            |
| -------------------------- | -------------------------- |
| wlan.fc.type_subtype == 32 | data frames                |
| wlan.fc.type_subtype == 33 | data+cf-ack                |
| wlan.fc.type_subtype == 34 | data+cf-poll               |
| wlan.fc.type_subtype == 35 | data+cf-ack + cf-ack       |
| wlan.fc.type_subtype == 36 | null data                  |
| wlan.fc.type_subtype == 37 | cf-ack                     |
| wlan.fc.type_subtype == 38 | cf-poll                    |
| wlan.fc.type_subtype == 39 | cf-ack + cf-poll           |
| wlan.fc.type_subtype == 40 | qos data                   |
| wlan.fc.type_subtype == 41 | qos data + cf-ack          |
| wlan.fc.type_subtype == 42 | qos data + cf-poll         |
| wlan.fc.type_subtype == 43 | qos data + cf-ack+ cf-poll |
| wlan.fc.type_subtype == 44 | qos null                   |
| wlan.fc.type_subtype == 46 | qos cf-poll                |
| wlan.fc.type_subtype == 47 | qos cf-ack + cf-poll       |


## Extras


| wlan.fc.retry ==1                       | retry frames                  |
| --------------------------------------- | ----------------------------- |
| wlan.fc.retry ==1 && wlan.fc.tods ==1   | towards ap                    |
| wlan.fc.retry ==1 && wlan.fc.fromds ==1 | from ap towards client device |


| wlan.fixed.action_code==7 | BSS Transition (Steering) |
| ------------------------- | ------------------------- |
| wlan.fixed.action_code==8 | BSS Transition (Steering) |


| wlan_radio.signal_dbm < -67                                 | weak signal filter |
| ----------------------------------------------------------- | ------------------ |
| wlan.fc.type_subtype == 0x05 && wlan_radio.signal_dbm < -75 | weak prob response |
| wlan.fc.type_subtype == 0x04 && wlan_radio.signal_dbm < -75 | weak prob requests |


**Display Filters related Weak signals:**


**Some Extras:**


| wlan.addr == mac address     | specific client by mac address |
| ---------------------------- | ------------------------------ |
| wlan.ta == mac address       | transmitter address            |
| wlan.ra == mac address       | receive address                |
| wlan.sa == mac address       | source address                 |
| wlan.da == mac address       | destination address            |
| wlan.bssid == ap mac address | radio mac address              |
| wlan.mgt.ssid == “your-ssid” | filter by ssid                 |


| wlan.fixed.action_code ==23                        | 802.11v dms request             |
| -------------------------------------------------- | ------------------------------- |
| wlan.fixed.action_code ==24                        | 802.11v dms respose             |
| wlan.fixed.action_code == 4                        | 802.11k neighbour request       |
| wlan.fixed.action_code == 5                        | 802.11k neighbour response      |
| (wlan.fc.type_subtype==0)&&(wlan.rsn.akms.type==3) | 802.11r auth request            |
| (wlan.fc.type_subtype==1)&&(wlan.tag.number==55)   | 802.11r auth response           |
| (wlan.fc.type_subtype==2)&&(wlan.tag.number==55)   | 802.11r re-association request  |
| (wlan.fc.type_subtype==3)&&(wlan.tag.number==55)   | 802.11r re-association response |

